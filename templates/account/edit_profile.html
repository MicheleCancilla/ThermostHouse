{% extends "main.html" %}

{% block title %}Modifica Utente{% endblock %}

{% block content %}

    <!-- File per la modifica del profilo utente -->


    <div class="container">
        <form class="col-lg-4" id="inputData" enctype="multipart/form-data"
              action="/edit_profile" method="post">

            <fieldset>
                <legend>Step 1: I tuoi dati</legend>
                <ol>
                    <li>
                        <label for="username">Name</label>
                        <input class="input-group" id="username" name="username" type="text"
                               value="{{ user.username }}"
                               placeholder="Il tuo User Name" required>
                    </li>
                    <li>
                        <label for="fileUser">Immagine profilo</label>
                        <input type="file" name="fileUser" onchange="onFileSelectedUser(event)">
                        <div id="borderimage">
                            <img id="myimageUser"
                                    {% if usr_image %}
                                 src="{{ usr_image }}"
                                 style=" height: 160px; width: 160px">
                                    {% endif %}
                        </div>
                    </li>
                </ol>
            </fieldset>

            {#                <fieldset>#}
            {#                    <legend>Step 2: Il tuo Indirizzo</legend>#}
            {#                    <ol>#}
            {#                        <li>#}
            {#                            <label for="city">* Città</label>#}
            {#                            <input id="city" name="city" type="text" value="{{ user.address.city }}"#}
            {#                                   placeholder="Selezionare una Città" required autofocus>#}
            {#                        </li>#}
            {#                        <li>#}
            {#                            <label for="province">* province</label>#}
            {#                            <select name="province" id="province" required>#}
            {#                                <option value='' selected disabled>Selezionare una province</option>#}
            {#                                <option value='AG'>AG - Agrigento</option>#}
            {#                                <option value='AL'>AL - Alessandria</option>#}
            {#                                <option value='AN'>AN - Ancona</option>#}
            {#                                <option value='AO'>AO - Aosta</option>#}
            {#                                <option value='AQ'>AQ - Aquila</option>#}
            {#                                <option value='AR'>AR - Arezzo</option>#}
            {#                                <option value='AP'>AP - Ascoli Piceno</option>#}
            {#                                <option value='AT'>AT - Asti</option>#}
            {#                                <option value='AV'>AV - Avellino</option>#}
            {#                                <option value='BA'>BA - Bari</option>#}
            {#                                <option value='BT'>BT - Barletta Andria Trani</option>#}
            {#                                <option value='BL'>BL - Belluno</option>#}
            {#                                <option value='BN'>BN - Benevento</option>#}
            {#                                <option value='BG'>BG - Bergamo</option>#}
            {#                                <option value='BI'>BI - Biella</option>#}
            {#                                <option value='BO'>BO - Bologna</option>#}
            {#                                <option value='BZ'>BZ - Bolzano</option>#}
            {#                                <option value='BS'>BS - Brescia</option>#}
            {#                                <option value='BR'>BR - Brindisi</option>#}
            {#                                <option value='CA'>CA - Cagliari</option>#}
            {#                                <option value='CL'>CL - Caltanissetta</option>#}
            {#                                <option value='CB'>CB - Campobasso</option>#}
            {#                                <option value='CE'>CE - Caserta</option>#}
            {#                                <option value='CT'>CT - Catania</option>#}
            {#                                <option value='CZ'>CZ - Catanzaro</option>#}
            {#                                <option value='CH'>CH - Chieti</option>#}
            {#                                <option value='CO'>CO - Como</option>#}
            {#                                <option value='CS'>CS - Cosenza</option>#}
            {#                                <option value='CR'>CR - Cremona</option>#}
            {#                                <option value='KR'>KR - Crotone</option>#}
            {#                                <option value='CN'>CN - Cuneo</option>#}
            {#                                <option value='EN'>EN - Enna</option>#}
            {#                                <option value='FM'>FM - Fermo</option>#}
            {#                                <option value='FE'>FE - Ferrara</option>#}
            {#                                <option value='FI'>FI - Firenze</option>#}
            {#                                <option value='FG'>FG - Foggia</option>#}
            {#                                <option value='FC'>FC - Forli Cesena</option>#}
            {#                                <option value='FR'>FR - Frosinone</option>#}
            {#                                <option value='GE'>GE - Genova</option>#}
            {#                                <option value='GO'>GO - Gorizia</option>#}
            {#                                <option value='GR'>GR - Grosseto</option>#}
            {#                                <option value='IM'>IM - Imperia</option>#}
            {#                                <option value='IS'>IS - Isernia</option>#}
            {#                                <option value='SP'>SP - La Spezia</option>#}
            {#                                <option value='LT'>LT - Latina</option>#}
            {#                                <option value='LE'>LE - Lecce</option>#}
            {#                                <option value='LC'>LC - Lecco</option>#}
            {#                                <option value='LI'>LI - Livorno</option>#}
            {#                                <option value='LO'>LO - Lodi</option>#}
            {#                                <option value='LU'>LU - Lucca</option>#}
            {#                                <option value='MC'>MC - Macerata</option>#}
            {#                                <option value='MN'>MN - Mantova</option>#}
            {#                                <option value='MS'>MS - Massa Carrara</option>#}
            {#                                <option value='MT'>MT - Matera</option>#}
            {#                                <option value='ME'>ME - Messina</option>#}
            {#                                <option value='MI'>MI - Milano</option>#}
            {#                                <option value='MO'>MO - Modena</option>#}
            {#                                <option value='MB'>MB - Monza Brianza</option>#}
            {#                                <option value='NA'>NA - Napoli</option>#}
            {#                                <option value='NO'>NO - Novara</option>#}
            {#                                <option value='NU'>NU - Nuoro</option>#}
            {#                                <option value='OR'>OR - Oristano</option>#}
            {#                                <option value='PD'>PD - Padova</option>#}
            {#                                <option value='PA'>PA - Palermo</option>#}
            {#                                <option value='PR'>PR - Parma</option>#}
            {#                                <option value='PV'>PV - Pavia</option>#}
            {#                                <option value='PG'>PG - Perugia</option>#}
            {#                                <option value='PU'>PU - Pesaro Urbino</option>#}
            {#                                <option value='PE'>PE - Pescara</option>#}
            {#                                <option value='PC'>PC - Piacenza</option>#}
            {#                                <option value='PI'>PI - Pisa</option>#}
            {#                                <option value='PT'>PT - Pistoia</option>#}
            {#                                <option value='PN'>PN - Pordenone</option>#}
            {#                                <option value='PZ'>PZ - Potenza</option>#}
            {#                                <option value='PO'>PO - Prato</option>#}
            {#                                <option value='RG'>RG - Ragusa</option>#}
            {#                                <option value='RA'>RA - Ravenna</option>#}
            {#                                <option value='RC'>RC - Reggio Calabria</option>#}
            {#                                <option value='RE'>RE - Reggio Emilia</option>#}
            {#                                <option value='RI'>RI - Rieti</option>#}
            {#                                <option value='RN'>RN - Rimini</option>#}
            {#                                <option value='RM'>RM - Roma</option>#}
            {#                                <option value='RO'>RO - Rovigo</option>#}
            {#                                <option value='SA'>SA - Salerno</option>#}
            {#                                <option value='SS'>SS - Sassari</option>#}
            {#                                <option value='SV'>SV - Savona</option>#}
            {#                                <option value='SI'>SI - Siena</option>#}
            {#                                <option value='SR'>SR - Siracusa</option>#}
            {#                                <option value='SO'>SO - Sondrio</option>#}
            {#                                <option value='TA'>TA - Taranto</option>#}
            {#                                <option value='TE'>TE - Teramo</option>#}
            {#                                <option value='TR'>TR - Terni</option>#}
            {#                                <option value='TO'>TO - Torino</option>#}
            {#                                <option value='TP'>TP - Trapani</option>#}
            {#                                <option value='TN'>TN - Trento</option>#}
            {#                                <option value='TV'>TV - Treviso</option>#}
            {#                                <option value='TS'>TS - Trieste</option>#}
            {#                                <option value='UD'>UD - Udine</option>#}
            {#                                <option value='VA'>VA - Varese</option>#}
            {#                                <option value='VE'>VE - Venezia</option>#}
            {#                                <option value='VB'>VB - Verbania</option>#}
            {#                                <option value='VC'>VC - Vercelli</option>#}
            {#                                <option value='VR'>VR - Verona</option>#}
            {#                                <option value='VV'>VV - Vibo Valentia</option>#}
            {#                                <option value='VI'>VI - Vicenza</option>#}
            {#                                <option value='VT'>VT - Viterbo</option>#}
            {#                            </select>#}
            {#                        </li>#}
            {#                        <li>#}
            {#                            <label for="region">* region</label>#}
            {#                            <select name="region" id="region" required>#}
            {#                                <option value='' selected disabled>Selezionare una region</option>#}
            {#                                <option value='Abruzzo'> Abruzzo</option>#}
            {#                                <option value='Basilicata'> Basilicata</option>#}
            {#                                <option value='Calabria'> Calabria</option>#}
            {#                                <option value='Campania'> Campania</option>#}
            {#                                <option value='Emilia-Romagna'> Emilia-Romagna</option>#}
            {#                                <option value='Friuli-Venezia Giulia'> Friuli-Venezia Giulia</option>#}
            {#                                <option value='Lazio'> Lazio</option>#}
            {#                                <option value='Liguria'> Liguria</option>#}
            {#                                <option value='Lombardia'> Lombardia</option>#}
            {#                                <option value='Marche'> Marche</option>#}
            {#                                <option value='Molise'> Molise</option>#}
            {#                                <option value='Piemonte'> Piemonte</option>#}
            {#                                <option value='Puglia'> Puglia</option>#}
            {#                                <option value='Sardegna'> Sardegna</option>#}
            {#                                <option value='Sicilia'> Sicilia</option>#}
            {#                                <option value='Toscana'> Toscana</option>#}
            {#                                <option value='Trentino-Alto Adige'> Trentino-Alto Adige</option>#}
            {#                                <option value='Umbria'> Umbria</option>#}
            {#                                <option value="Valle d'Aosta"> Valle d'Aosta</option>#}
            {#                                <option value='Veneto'> Veneto</option>#}
            {#                            </select>#}
            {#                        </li>#}
            {#                        <li>#}
            {#                            <label for="zip_code">* CAP</label>#}
            {#                            <input id="zip_code" name="zip_code" type="number" value="{{ user.address.zip_code }}"#}
            {#                                   placeholder="Selezionare un CAP" required>#}
            {#                        </li>#}
            {#                        <li>#}
            {#                            <label for="street">* Via/Piazza</label>#}
            {#                            <input id="street" name="street" type="text" value="{{ user.address.street }}"#}
            {#                                   placeholder="Selezionare una Via/Pz." required>#}
            {#                        </li>#}
            {#                        <li>#}
            {#                            <label for="number">* Civico</label>#}
            {#                            <input id="number" name="number" type="number" value="{{ user.address.number }}"#}
            {#                                   placeholder="Seleziona il numero number" required>#}
            {#                        </li>#}
            {#                        <li>#}
            {#                            <label for="nation">* Nazione</label>#}
            {#                            <input id="nation" name="nation" type="text" value="Italy" required disabled>#}
            {#                        </li>#}
            {#                    </ol>#}
            {#                </fieldset>#}


            <!-- BEGIN: Scripts per la preselezione delle listbox e dei radio button -->
            <script>
                //Acquisisco i dati json per per poterli trattare in javascript
                var data = {{ js_data|safe }};
            </script>

            {% if user.address %}
                <script>
                    var province = document.getElementById("province");
                    usr_province = data["province"];
                    var region = document.getElementById("region");
                    usr_region = data["region"];

                    for (var i = 0; i < province.options.length; i++) {
                        if (province.options[i].value == usr_province) {
                            province.options[i].selected = true;
                        }
                    }

                    for (var i = 0; i < region.options.length; i++) {
                        if (region.options[i].value == usr_region) {
                            region.options[i].selected = true;
                        }
                    }
                </script>
            {% endif %}

            {% if user.impianto %}
                <script>
                    var tipo = document.getElementById("tipo");
                    usr_tipo = data["tipo"];


                    for (var i = 0; i < tipo.options.length; i++) {
                        if (tipo.options[i].value == usr_tipo) {
                            tipo.options[i].selected = true;
                        }
                    }

                    var alimentazione = data["alimentazione"];
                    document.getElementById(alimentazione).checked = true;

                    var noleggio = "noleggioNO";
                    if (data["noleggio"] == "true")
                        noleggio = "noleggioSI";
                    document.getElementById(noleggio).checked = true;

                    document.getElementById("descrizione").value = data["descrizione"];

                </script>
            {% endif %}
            <!-- BEGIN: Scripts per la preselezione delle listbox e dei radio button -->

            <!-- BEGIN: Script per il caricamento dell'immagine selezionata (IMPIANTO)-->
            <script>
                function onFileSelectedPlant(event) {
                    var selectedFile = event.target.files[0];
                    var reader = new FileReader();

                    var imgtag = document.getElementById("myimage");
                    imgtag.title = selectedFile.name;

                    reader.onload = function (event) {
                        imgtag.src = event.target.result;
                    };

                    reader.readAsDataURL(selectedFile);
                }
            </script>
            <!-- END: Script per il caricamento dell'immagine selezionata -->

            <!-- BEGIN: Script per il caricamento dell'immagine selezionata (UTENTE) -->
            <script>
                function onFileSelectedUser(event) {
                    var selectedFile = event.target.files[0];
                    var reader = new FileReader();

                    var imgtag = document.getElementById("myimageUser");
                    imgtag.title = selectedFile.name;

                    reader.onload = function (event) {
                        imgtag.src = event.target.result;
                    };

                    reader.readAsDataURL(selectedFile);
                }
            </script>
            <!-- END: Script per il caricamento dell'immagine selezionata -->


            <fieldset>
                <button class="btn btn-primary btn-lg" type=submit>Conferma!</button>
            </fieldset>
        </form>
    </div>
{% endblock %}
